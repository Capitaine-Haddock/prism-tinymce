tinymce.PluginManager.add('prism', function(editor, url) {
    
    var languageList = [
        'Markup',
        'CSS',
        'Javascript',
        'PHP',
        'CoffeeScript',
        'Sass',
        'Bash',
        'SQL',
        'HTTP',
        'Ruby',
        'Ini',
        'Apache',
        'Git',
        'Less',
        'Markdown'
    ];

    var menuLanguages = [];
    tinymce.each(languageList, function(language) {
        menuLanguages.push({
            text: language,
            onclick: function(e) {
                editor.focus();
                console.log(editor.selection.getContent());
                if (editor.selection.getContent() == null || editor.selection.getContent() == "") {
                    content = "/**\n" +
                        " *\n" +
                        " *\n" +
                        " * Insert your content here\n" +
                        " *\n" +
                        " *\n" +  
                        "*/\n";                     
                } else {
                    content = editor.selection.getContent();
                }
                editor.selection.setContent('<pre class="language-' + language.toLowerCase() + '"><code>' + content + '</code></pre>');
                //editor.insertContent('<pre class="language-' + language.toLowerCase() + '"><code>sddsd</code></pre>');
            }
        });
    });

    editor.addButton('prism', {
        text: 'Languages',
        type: 'menubutton',
        icon: false,
        menu: menuLanguages
    });

});