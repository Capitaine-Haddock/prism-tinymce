tinymce.PluginManager.add('prism', function(editor, url) {
    
    var languageList = [
        'Markup',
        'CSS',
        'Javascript',
        'PHP',
        'CoffeeScript',
        'Sass',
        'Bash',
        'SQL',
        'HTTP',
        'Ruby',
        'Ini',
        'Apache',
        'Git',
        'Less',
        'Markdown'
    ];

    var menuLanguages = [];
    tinymce.each(languageList, function(language) {
        menuLanguages.push({
            text: language,
            onclick: function(e) {
                console.log(e);
                editor.focus();
                editor.selection.setContent('<pre class="language-' + language.toLowerCase() + '"<code>' + editor.selection.getContent() + '</code></pre>');
            }
        });
    });

    editor.addButton('prism', {
        text: 'Languages',
        type: 'menubutton',
        icon: false,
        menu: menuLanguages
    });

});